---
import { getCollection } from "astro:content";
import dayjs from "dayjs";

import Center from "../../components/Center.astro";
import PageHeader from "../../components/PageHeader.astro";
import ProjectPreview from "../../components/ProjectPreview.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";

const projects = await getCollection("projects");
const sortedProjects = projects.sort((a, b) =>
  dayjs(a.data.datePublished).isAfter(dayjs(b.data.datePublished)) ? -1 : 1
);

const title = "Projects";
const description = "It’s things I made for internet.";
---

<BaseLayout title={title} description={description} includeFooter padBottom>
  <PageHeader title={title} description={description} slug="projects" />
  <Center>
    <section class="projects">
      {
        sortedProjects.map(({ data }) => (
          <ProjectPreview
            title={data.title}
            description={data.description}
            datePublished={data.datePublished}
            img={data.img}
            imgAlt={data.imgAlt}
            url={data.url}
            repo={data.repo}
          />
        ))
      }
    </section>
    <div class="banner">
      <strong>Looking for case studies?</strong>
      <p>
        They’ll be here soon! In the meantime, for work samples from past
        employers, email <a href="mailto:hey@evadecker.com">hey@evadecker.com</a
        >.
      </p>
    </div>
  </Center>
</BaseLayout>

<style lang="scss">
  .projects {
    display: flex;
    flex-direction: column;
    gap: 3em;
    padding-block-end: 4em;
  }

  .banner {
    background: var(--jade-3);
    border-radius: var(--radius-s);
    padding: var(--space-m) var(--space-l);

    p {
      line-height: 1.2;
      margin-block-start: var(--space-2xs);
    }

    a {
      color: var(--jade-9);
      text-decoration: underline;
    }
  }
</style>
