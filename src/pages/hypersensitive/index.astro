---
import UnstyledBase from "../../layouts/UnstyledBase.astro";
---

<UnstyledBase
  title="HYPERSENSITIVE"
  description="It’s all too much."
  ogImage="/images/hypersensitive.png"
  ogAlt="The event is too bright. The city is too uncomfortable. The brain is too humid. The light is too nervous."
>
  <main id="canvas"></main>
</UnstyledBase>

<script>
  const attribute = [
    ["everything", "is"],
    ["it’s", "all"],
    ["the", "ads", "are"],
    ["the", "air", "is"],
    ["the", "app", "is"],
    ["the", "atmosphere", "is"],
    ["the", "bar", "is"],
    ["the", "beach", "is"],
    ["the", "brain", "is"],
    ["the", "building", "is"],
    ["the", "buildings", "are"],
    ["the", "bus", "is"],
    ["the", "car", "is"],
    ["the", "cars", "are"],
    ["the", "chair", "is"],
    ["the", "city", "is"],
    ["the", "climate", "is"],
    ["the", "clothes", "are"],
    ["the", "colors", "are"],
    ["the", "conversation", "is"],
    ["the", "crowd", "is"],
    ["the", "discussion", "is"],
    ["the", "electricity", "is"],
    ["the", "email", "is"],
    ["the", "environment", "is"],
    ["the", "event", "is"],
    ["the", "eye contact", "is"],
    ["the", "feet", "are"],
    ["the", "food", "is"],
    ["the", "furniture", "is"],
    ["the", "future", "is"],
    ["the", "honking", "is"],
    ["the", "humming", "is"],
    ["the", "information", "is"],
    ["the", "internet", "is"],
    ["the", "light", "is"],
    ["the", "lights", "are"],
    ["the", "message", "is"],
    ["the", "motion", "is"],
    ["the", "mouthfeel", "is"],
    ["the", "movement", "is"],
    ["the", "movie", "is"],
    ["the", "music", "is"],
    ["the", "news", "is"],
    ["the", "noises", "are"],
    ["the", "objects", "are"],
    ["the", "office", "is"],
    ["the", "park", "is"],
    ["the", "party", "is"],
    ["the", "past", "is"],
    ["the", "people", "are"],
    ["the", "phone call", "is"],
    ["the", "phone", "is"],
    ["the", "place", "is"],
    ["the", "restaurant", "is"],
    ["the", "road", "is"],
    ["the", "room", "is"],
    ["the", "screens", "are"],
    ["the", "sensation", "is"],
    ["the", "shop", "is"],
    ["the", "show", "is"],
    ["the", "smells", "are"],
    ["the", "sounds", "are"],
    ["the", "space", "is"],
    ["the", "street", "is"],
    ["the", "talking", "is"],
    ["the", "taste", "is"],
    ["the", "temperature", "is"],
    ["the", "text", "is"],
    ["the", "texture", "is"],
    ["the", "thoughts", "are"],
    ["the", "touch", "is"],
    ["the", "traffic", "is"],
    ["the", "train", "is"],
    ["the", "travel", "is"],
    ["the", "trucks", "are"],
    ["the", "TV", "is"],
    ["the", "voices", "are"],
    ["the", "walk", "is"],
    ["the", "walls", "are"],
    ["the", "wealth", "is"],
    ["the", "weather", "is"],
    ["the", "website", "is"],
    ["the", "words", "are"],
  ];

  const quality = [
    "abrasive",
    "acidic",
    "aggressive",
    "angry",
    "backwards",
    "big",
    "bitter",
    "boomy",
    "bright",
    "chalky",
    "chaotic",
    "clammy",
    "clanging",
    "claustrophobic",
    "close",
    "cloying",
    "clumpy",
    "cold",
    "complex",
    "confining",
    "confusing",
    "cramped",
    "crinkly",
    "crowded",
    "crumbly",
    "damp",
    "deafening",
    "demanding",
    "dense",
    "discordant",
    "disjointed",
    "disordered",
    "disorienting",
    "dissonant",
    "distorted",
    "distressing",
    "dizzying",
    "dusty",
    "excessive",
    "exhausting",
    "fast",
    "flickery",
    "forced",
    "fragrant",
    "giant",
    "grating",
    "greasy",
    "harsh",
    "heavy",
    "high-pitched",
    "humid",
    "hurried",
    "illegible",
    "illogical",
    "impatient",
    "impenetrable",
    "intense",
    "intrusive",
    "itchy",
    "jarring",
    "jittery",
    "littered",
    "looming",
    "loud",
    "lumpy",
    "messy",
    "metallic",
    "much",
    "muddy",
    "mushy",
    "musty",
    "narrow",
    "nauseating",
    "nervous",
    "noisy",
    "nonsensical",
    "oily",
    "packed",
    "painful",
    "pressing",
    "prickly",
    "rapid",
    "repetitive",
    "restless",
    "rigid",
    "rough",
    "rushed",
    "scratchy",
    "screeching",
    "sensational",
    "shaky",
    "sharp",
    "shouty",
    "shrill",
    "slimy",
    "smelly",
    "spiky",
    "squeaky",
    "starchy",
    "stifling",
    "stinky",
    "stuffy",
    "sudden",
    "suffocating",
    "synthetic",
    "talkative",
    "tight",
    "tinny",
    "tiring",
    "uncanny",
    "uncomfortable",
    "unexpected",
    "unhygienic",
    "unnatural",
    "vibrant",
    "vibrating",
    "violent",
    "vivid",
    "warm",
    "wet",
  ];

  function getRandomValueWithinRange(min: number, max: number): number {
    return Math.random() * (max - min) + min;
  }

  function getRandomAttribute(): string[] {
    return attribute[Math.floor(Math.random() * attribute.length)];
  }

  function getRandomQuality(): string {
    return quality[Math.floor(Math.random() * quality.length)];
  }

  function getSentence(): string {
    return [...getRandomAttribute(), "too", getRandomQuality()].join(" ");
  }

  function addSentence() {
    let canvasDOMElem = document.getElementById("canvas");
    if (!canvasDOMElem) return;

    const fragment = document.createDocumentFragment();

    let sentenceWrapper = fragment.appendChild(document.createElement("div"));
    sentenceWrapper.classList.add("sentence-wrapper");

    // Inline text
    let sentence = sentenceWrapper.appendChild(document.createElement("p"));
    sentence.classList.add("sentence");
    sentence.style.fontSize = `${getRandomValueWithinRange(1, 1.2)}em`;
    sentence.style.fontStretch = `${getRandomValueWithinRange(40, 80)}%`;
    sentence.style.color = `hsl(${Math.random() * 360}, 100%, 50%)`;
    sentence.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 10%)`;

    sentence.textContent = getSentence();

    canvasDOMElem.appendChild(sentenceWrapper);

    // Positioning
    // (Must take place after the element has been added to the DOM)
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;

    const elementWidth = sentenceWrapper.offsetWidth;
    const elementHeight = sentenceWrapper.offsetHeight;

    const maxX = viewportWidth - elementWidth;
    const maxY = viewportHeight - elementHeight;

    const randomX = Math.floor(Math.random() * maxX);
    const randomY = Math.floor(Math.random() * maxY);

    sentenceWrapper.style.left = `${randomX}px`;
    sentenceWrapper.style.top = `${randomY}px`;
    sentenceWrapper.style.transform = `rotate(${(Math.random() - 0.5) * 10}deg)`;
  }

  function setRandomInterval(
    intervalFunction: () => void,
    minDelay: number,
    maxDelay: number
  ) {
    let timeout: NodeJS.Timeout;

    const runInterval = () => {
      const timeoutFunction = () => {
        intervalFunction();
        runInterval();
      };

      const delay =
        Math.floor(Math.random() * (maxDelay - minDelay + 1)) + minDelay;

      timeout = setTimeout(timeoutFunction, delay);
    };

    runInterval();

    return {
      clear() {
        clearTimeout(timeout);
      },
    };
  }

  setRandomInterval(addSentence, 300, 300);
</script>

<style is:global lang="scss">
  html,
  body {
    background: #111;
  }

  #canvas {
    position: relative;
    height: 100dvh;
    width: 100vw;
    overflow: hidden;
    padding: var(--space-l);
    font-family:
      system-ui,
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      Roboto,
      Oxygen,
      Ubuntu,
      Cantarell,
      "Open Sans",
      "Helvetica Neue",
      sans-serif;
    font-weight: 500;
    font-size: 40px;
    line-height: 1;

    @media (width < 960px) {
      font-size: 32px;
    }

    @media (width < 640px) {
      font-size: 28px;
    }
  }

  .sentence-wrapper {
    position: absolute;
  }

  .sentence {
    line-height: 1;
    text-transform: uppercase;
    display: inline;
  }
</style>
