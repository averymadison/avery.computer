---
import { Icon } from "@components";
import dayjs from "dayjs";
import advancedFormat from "dayjs/plugin/advancedFormat";
import localizedFormat from "dayjs/plugin/localizedFormat";
import relativeTime from "dayjs/plugin/relativeTime";
import timezone from "dayjs/plugin/timezone";
import utc from "dayjs/plugin/utc";

import * as styles from "./footer.css";

const { timestamp } = Astro.props;

dayjs.extend(utc);
dayjs.extend(timezone);
dayjs.extend(localizedFormat);
dayjs.extend(relativeTime);
dayjs.extend(advancedFormat);

dayjs.tz.setDefault("America/New_York");

let formattedTimestamp: string;
let relativeTimeInWords: string;

if (timestamp !== null) {
  formattedTimestamp = dayjs(timestamp).format("LLLL z");
  relativeTimeInWords = dayjs(timestamp).fromNow();
} else {
  formattedTimestamp = "";
  relativeTimeInWords = "at some point in time";
}
---

<div class={styles.lastTended}>
  <Icon icon="seedling" size="small" className={styles.lastTendedIcon} />
  <small>
    Last tended{" "}
    <time datetime={timestamp} title={formattedTimestamp}
      >{relativeTimeInWords}</time
    >
  </small>
</div>
